<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>QB Tournament â€” Head-to-Head Auto-Advance</title>
  <style>
    body {
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#222;
    }
    .app {
      width:960px; max-width:96%;
      background:rgba(255,255,255,0.98);
      border-radius:14px;
      padding:26px;
      box-shadow:0 30px 60px rgba(0,0,0,0.18);
    }
    header { display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
    h1 { font-size:20px; margin:0; }
    button {
      background:#667eea; color:#fff;
      border:none; padding:8px 12px;
      border-radius:8px; cursor:pointer; font-weight:600;
    }
    button.ghost { background:transparent; color:#667eea; border:2px solid #667eea; }
    .status { color:#b00020; min-height:18px; margin-bottom:8px; }

    .progress { height:10px; background:#eee; border-radius:8px; overflow:hidden; margin:12px 0; }
    .progress > .bar { height:100%; background: linear-gradient(90deg,#4CAF50,#45a049); width:0%; transition:width .25s ease; }

    /* Rating */
    .player-photo { width:340px; height:340px; object-fit:cover; border-radius:12px; margin:12px auto; display:block; }
    .playerName { font-size:22px; font-weight:700; }
    .playerTeam { color:#666; margin-bottom:12px; }
    .rating-buttons { display:flex; justify-content:center; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
    .rating-buttons button { width:46px; height:46px; border-radius:50%; border:2px solid #ddd; background:white; font-weight:700; color:#000; }
    .rating-buttons button.selected { background:#667eea; color:#fff; border-color:#667eea; }

    /* Divisions */
    .division-grid { display:grid; grid-template-columns: repeat(4,1fr); gap:12px; }
    .division-card { background:#fafafa; border:2px solid #667eea; border-radius:10px; padding:8px; cursor:pointer; text-align:center; }
    .division-card img{ width:100%; height:160px; object-fit:cover; border-radius:8px; margin-bottom:6px; }
    .division-card:hover { background:#667eea; color:#fff; }

    /* Matchups */
    .matchup { display:flex; justify-content:center; gap:20px; margin-top:20px; }
    .match-card { width:280px; background:#fff; border-radius:12px; padding:10px; text-align:center; cursor:pointer; border:2px solid transparent; }
    .match-card img{ width:100%; height:240px; object-fit:cover; border-radius:8px; margin-bottom:8px; }
    .match-card:hover { border-color:#667eea; background:#eef; }

    /* Champion */
    .champion { text-align:center; }
    .champion img { width:300px; height:300px; object-fit:cover; border-radius:12px; margin:12px 0; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>QB Tournament</h1>
      <button class="ghost" onclick="restartAll()">Restart</button>
    </header>
    <div class="status" id="status"></div>

    <!-- Rating -->
    <section id="ratingSection">
      <div class="progress"><div class="bar" id="progressBar"></div></div>
      <div id="playerCounter"></div>
      <img id="playerImage" class="player-photo">
      <div class="playerName" id="playerName"></div>
      <div class="playerTeam" id="playerTeam"></div>
      <div class="rating-buttons" id="ratingButtons"></div>
      <button id="nextBtn" disabled onclick="submitRating()">Next Player</button>
    </section>

    <!-- Division selection -->
    <section id="divisionSection" style="display:none;">
      <h2 id="divisionHeader"></h2>
      <div class="division-grid" id="divisionGrid"></div>
    </section>

    <!-- Bracket -->
    <section id="bracketSection" style="display:none;">
      <h2 id="roundHeader"></h2>
      <div id="matchupArea"></div>
    </section>

    <!-- Champion -->
    <section id="championSection" style="display:none;" class="champion">
      <h2>Champion</h2>
      <img id="championImg">
      <div id="championName"></div>
      <div id="championTeam"></div>
    </section>

    <!-- Data -->
    <script id="playerData" type="text/csv">
Jalen Hurts,Eagles,JalenHurts3.png,NFC East
Dak Prescott,Cowboys,DakPrescott3.png,NFC East
Jayden Daniels,Commies,JaydenDaniels.jpeg,NFC East
Russell Wilson,Giants,RussellWilson.jpeg,NFC East
Baker Mayfield,Buccaneers,BakerMayfield.png,NFC South
Michael Penix,Falcons,MichaelPenix.png,NFC South
Bryce Young,Panthers,BryceYoung.png,NFC South
Spencer Rattler,Saints,SpencerRattler.jpeg,NFC South
Sam Darnold,Seahawks,SamDarnold.png,NFC West
Brock Purdy,49ers,BrockPurdy.jpeg,NFC West
Matt Stafford,Rams,MattStafford.png,NFC West
Kyler Murray,Cardinals,KylerMurray.webp,NFC West
Jordan Love,Packers,JordanLove.webp,NFC North
JJ McCarthy,Vikings,JJMcCarthy.png,NFC North
Jared Goff,Lions,JaredGoff.png,NFC North
Caleb Williams,Bears,CalebWilliams.png,NFC North
Geno Smith,Raiders,GenoSmith.png,AFC West
Justin Herbert,Chargers,JustinHerbert2.png,AFC West
Bo Nix,Broncos,BoNix.png,AFC West
Patrick Mahomes,Chiefs,PatrickMahomes.png,AFC West
Joe Burrow,Bengals,JoeBurrow.png,AFC North
Lamar Jackson,Ravens,LamarJackson.png,AFC North
Aaron Rodgers,Steelers,AaronRodgers.png,AFC North
Joe Flacco,Browns,JoeFlacco.png,AFC North
Josh Allen,Bills,JoshAllen2.png,AFC East
Drake Maye,Patriots,DrakeMaye.png,AFC East
Justin Fields,Jets,JustinFields.png,AFC East
Tua Tagovailoa,Dolphins,Tua.png,AFC East
Trevor Lawrence,Jaguars,TrevorLawrence.png,AFC South
Daniel Jones,Colts,DanielJones.png,AFC South
CJ Stroud,Texans,CJStroud.png,AFC South
Cam Ward,Titans,CamWard.png,AFC South
    </script>

    <script>
      let players=[], ratings=[], currentPlayerIndex=0, selectedRating=null;
      let divisions={}, divisionOrder=[], divisionWinners=[];
      let round=0, matches=[], matchIndex=0;

      const pairings=[
        ["NFC East","NFC North"],
        ["NFC South","NFC West"],
        ["AFC East","AFC South"],
        ["AFC West","AFC North"]
      ];

      function parseCSV(txt){return txt.trim().split(/\r?\n/).map(l=>l.split(',')).map(a=>({name:a[0],team:a[1],image:a[2],division:a[3]}));}
      function loadPlayers(){
        players=parseCSV(document.getElementById('playerData').textContent);
        ratings=[]; currentPlayerIndex=0; loadCurrent();
      }
      function loadCurrent(){
        const p=players[currentPlayerIndex];
        document.getElementById('playerCounter').textContent=`Player ${currentPlayerIndex+1} of ${players.length}`;
        document.getElementById('playerName').textContent=p.name;
        document.getElementById('playerTeam').textContent=p.team;
        document.getElementById('playerImage').src="images/"+p.image;
        const bar=Math.round((currentPlayerIndex/players.length)*100);
        document.getElementById('progressBar').style.width=bar+"%";
        const rb=document.getElementById('ratingButtons'); rb.innerHTML="";
        for(let i=0;i<=6;i++){
          const b=document.createElement("button"); b.textContent=i;
          b.onclick=()=>{selectedRating=i; document.querySelectorAll('#ratingButtons button').forEach(x=>x.classList.remove('selected')); b.classList.add('selected'); document.getElementById('nextBtn').disabled=false;};
          rb.appendChild(b);
        }
        document.getElementById('nextBtn').disabled=true;
      }
      function submitRating(){
        ratings.push({...players[currentPlayerIndex],rating:selectedRating});
        currentPlayerIndex++;
        if(currentPlayerIndex<players.length){ loadCurrent(); }
        else{ prepareDivisions(); startDivisionSelection(); }
      }

      function prepareDivisions(){
        divisions={}; ratings.forEach(p=>{ if(!divisions[p.division])divisions[p.division]=[]; divisions[p.division].push(p); });
        divisionOrder=Object.keys(divisions);
        for(const d in divisions){ divisions[d].sort((a,b)=>b.rating-a.rating); }
      }
      function startDivisionSelection(){ document.getElementById('ratingSection').style.display="none"; showDivision(0); }
      function showDivision(i){
        if(i>=divisionOrder.length){ startBracket(); return; }
        const d=divisionOrder[i];
        document.getElementById('divisionSection').style.display="block";
        document.getElementById('divisionHeader').textContent=d;
        const g=document.getElementById('divisionGrid'); g.innerHTML="";
        divisions[d].forEach(p=>{
          const card=document.createElement("div"); card.className="division-card";
          card.innerHTML=`<img src="images/${p.image}" onerror="this.style.display='none'"><div>${p.name} (${p.rating})</div><div>${p.team}</div>`;
          card.onclick=()=>{ divisionWinners.push(p); showDivision(i+1); };
          g.appendChild(card);
        });
      }

      function startBracket(){
        document.getElementById('divisionSection').style.display="none";
        round=1; matchIndex=0;
        matches = pairings.map(([a,b])=>({a:divisionWinners.find(x=>x.division===a), b:divisionWinners.find(x=>x.division===b)}));
        showMatch();
      }
      function showMatch(){
        document.getElementById('bracketSection').style.display="block";
        const header=document.getElementById('roundHeader');
        if(round===1) header.textContent="Quarterfinals";
        if(round===2) header.textContent="Semifinals";
        if(round===3) header.textContent="Final";
        const m = matches[matchIndex];
        const area=document.getElementById('matchupArea'); area.innerHTML="";
        const wrap=document.createElement("div"); wrap.className="matchup";
        wrap.appendChild(makeCard(m.a,()=>pickWinner(m.a)));
        wrap.appendChild(makeCard(m.b,()=>pickWinner(m.b)));
        area.appendChild(wrap);
      }
      function makeCard(p,onclick){
        const c=document.createElement("div"); c.className="match-card";
        c.innerHTML=`<img src="images/${p.image}" onerror="this.style.display='none'"><div><b>${p.name} (${p.rating})</b></div><div>${p.team}</div>`;
        c.onclick=onclick; return c;
      }
      function pickWinner(p){
        matches[matchIndex].winner=p;
        matchIndex++;
        if(matchIndex<matches.length){ showMatch(); }
        else{
          if(round===1){ // go to semis
            matches=[
              {a:matches[0].winner,b:matches[1].winner},
              {a:matches[2].winner,b:matches[3].winner}
            ]; round=2; matchIndex=0; showMatch();
          } else if(round===2){ // go to final
            matches=[{a:matches[0].winner,b:matches[1].winner}]; round=3; matchIndex=0; showMatch();
          } else if(round===3){ showChampion(matches[0].winner); }
        }
      }
      function showChampion(champ){
        document.getElementById('bracketSection').style.display="none";
        document.getElementById('championSection').style.display="block";
        document.getElementById('championImg').src="images/"+champ.image;
        document.getElementById('championName').textContent=`${champ.name} (${champ.rating})`;
        document.getElementById('championTeam').textContent=champ.team;
      }

      function restartAll(){
        divisionWinners=[]; ratings=[]; currentPlayerIndex=0;
        document.getElementById('championSection').style.display="none";
        document.getElementById('bracketSection').style.display="none";
        document.getElementById('divisionSection').style.display="none";
        document.getElementById('ratingSection').style.display="block";
        loadPlayers();
      }
      document.addEventListener('DOMContentLoaded',loadPlayers);
    </script>
  </div>
</body>
</html>